# Server: Network Manager

## Clases

![Figure1](/docs/imgs/CD_Server_Network_Manager.png)

_Figure 1. Diagrama de Clase Network Manager_

El diagrama editable se encuentra en [este link](https://drive.google.com/file/d/1g025fhle7SZ9MlFeQbGAMuW5SJc0jiCr/view?usp=sharing).


| Componente    | Definición                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| ------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Server        | Contiene los procesos para iniciar o para el servidor, así como el manejo de los clientes a través de un pool de hilos. <ul><li>`MAX_CLIENTS` _int_: El número máximo de clientes conectados al servidor que se van a estar manejando.</li><li>`clients` _List\<ClientHandler\>_: Instancias de los clientes que se vayan conectando al servidor.</li><br><li>`startServer():void`: Es donde se inicia el servidor, que sería la creación del pool de hilos, iniciar el socket server y estar escuchando nuevos clientes.</li><li>`stopServer():void`: Termina el proceso del servidor.</li><li>`handleClient(clientSocket):void`: Instancia un ClientHandler cuando el socket del server ha aceptado una nueva conexión, y la agrega a la lista de `clients`.</li></ul>                                                                                                                                                                        |
| EventConsumer | Interfaz que representa a una clase que puede consumir eventos ([Event](/docs/diagrams/EventSchema.md#clases)).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| EventProducer | Interfaz que representa a una clase que puede publicar eventos.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ClientHandler | Se encarga de manejar la conexión con el cliente. <br> Procesa los mensajes (eventos) recibidos y mandar mensajes (eventos) al cliente.<ul><li>`clientSocket` _Socket_: El socket con conexión al cliente.</li><li>`eventBus` _EventBus_: Referencia al bus de evento subscrito.<li>`output` _ObjectOutputStream_: Canal por el que se envían objetos al otro socket conectado. <li>`input` _ObjectInputStream_: Canal por el que se reciben objetos del otro socket conectado.</ul><ul><li>`ClientHandler(Socket clientSocket, EventBus eventBus):void `: Constructor, necesita del socket con la conexión creada y el bus de evento al que se va a suscribir.<li>`handleClientRequest():void`: Procesa los mensajes nuevos que le lleguen al socket. <li>`run():void`: Necesario para que pueda ser mandado a un hilo. (de la interfaz [Runnable](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Runnable.html))</ul> |
| EventBus      | Se encarga de recibir eventos y mandarlos a todos los EventConsumers suscritos. <ul>`consumers` _List\<EventConsumer\>_: Contiene referencia de todos los consumidores.</ul> <ul><li>`suscribe(EventConsumer consumer):void`: Suscribe un consumidor al bus. <li>`unsuscribe(EventConsumer consumer):void`: Desuscribe un consumidor. <li>`sendEvent(Event event):void`: Método por el cual se envian eventos al bus, los cuales se van a notificar a los consumidores.</ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |